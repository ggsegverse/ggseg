<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Plotting external data • ggseg</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Inter-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting external data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://ggseg.github.io" class="external-link">
  <img src="ggsegverse-logo.png" id="ggsegverse-logo" alt="ggsegverse"></a>

    <a class="navbar-brand me-2" href="../index.html">ggseg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/ggseg.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="../articles/ggseg.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/external-data.html">External Data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced Usage</h6></li>
    <li><a class="dropdown-item" href="../articles/positioning-views.html">Positioning Views</a></li>
    <li><a class="dropdown-item" href="../articles/geom-sf.html">Using geom_sf</a></li>
    <li><a class="dropdown-item" href="../articles/freesurfer-files.html">FreeSurfer Files</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ggsegverse/ggseg" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plotting external data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ggsegverse/ggseg/blob/main/vignettes/external-data.Rmd" class="external-link"><code>vignettes/external-data.Rmd</code></a></small>
      <div class="d-none name"><code>external-data.Rmd</code></div>
    </div>

    
    
<p>Most of the time, you’re not plotting empty atlases. You have results
– p-values, cortical thickness, whatever – and you want them on a brain.
This vignette covers how to get your data into the right shape for
ggseg.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggsegverse.github.io/ggseg/">ggseg</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="how-matching-works">How matching works<a class="anchor" aria-label="anchor" href="#how-matching-works"></a>
</h2>
<p><code><a href="../reference/ggbrain.html">geom_brain()</a></code> joins your data to the atlas by any columns
they share. That means your data needs at least one column with names
that match the atlas. The two columns you’ll use most:</p>
<ul>
<li>
<strong>region</strong> – human-readable names like “insula” or
“precentral”</li>
<li>
<strong>label</strong> – FreeSurfer labels like “lh_bankssts”</li>
</ul>
<p>Check what’s available:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggseg.formats</span><span class="fu">::</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/atlas_regions.html">atlas_regions</a></span><span class="op">(</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "banks of superior temporal sulcus" "caudal anterior cingulate"        </span></span>
<span><span class="co">##  [3] "caudal middle frontal"             "corpus callosum"                  </span></span>
<span><span class="co">##  [5] "cuneus"                            "entorhinal"                       </span></span>
<span><span class="co">##  [7] "frontal pole"                      "fusiform"                         </span></span>
<span><span class="co">##  [9] "inferior parietal"                 "inferior temporal"                </span></span>
<span><span class="co">## [11] "insula"                            "isthmus cingulate"                </span></span>
<span><span class="co">## [13] "lateral occipital"                 "lateral orbitofrontal"            </span></span>
<span><span class="co">## [15] "lingual"                           "medial orbitofrontal"             </span></span>
<span><span class="co">## [17] "middle temporal"                   "paracentral"                      </span></span>
<span><span class="co">## [19] "parahippocampal"                   "pars opercularis"                 </span></span>
<span><span class="co">## [21] "pars orbitalis"                    "pars triangularis"                </span></span>
<span><span class="co">## [23] "pericalcarine"                     "postcentral"                      </span></span>
<span><span class="co">## [25] "posterior cingulate"               "precentral"                       </span></span>
<span><span class="co">## [27] "precuneus"                         "rostral anterior cingulate"       </span></span>
<span><span class="co">## [29] "rostral middle frontal"            "superior frontal"                 </span></span>
<span><span class="co">## [31] "superior parietal"                 "superior temporal"                </span></span>
<span><span class="co">## [33] "supramarginal"                     "temporal pole"                    </span></span>
<span><span class="co">## [35] "transverse temporal"</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggseg.formats</span><span class="fu">::</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/atlas_labels.html">atlas_labels</a></span><span class="op">(</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "lh_bankssts"                 "lh_caudalanteriorcingulate" </span></span>
<span><span class="co">##  [3] "lh_caudalmiddlefrontal"      "lh_corpuscallosum"          </span></span>
<span><span class="co">##  [5] "lh_cuneus"                   "lh_entorhinal"              </span></span>
<span><span class="co">##  [7] "lh_frontalpole"              "lh_fusiform"                </span></span>
<span><span class="co">##  [9] "lh_inferiorparietal"         "lh_inferiortemporal"        </span></span>
<span><span class="co">## [11] "lh_insula"                   "lh_isthmuscingulate"        </span></span>
<span><span class="co">## [13] "lh_lateraloccipital"         "lh_lateralorbitofrontal"    </span></span>
<span><span class="co">## [15] "lh_lingual"                  "lh_medialorbitofrontal"     </span></span>
<span><span class="co">## [17] "lh_middletemporal"           "lh_paracentral"             </span></span>
<span><span class="co">## [19] "lh_parahippocampal"          "lh_parsopercularis"         </span></span>
<span><span class="co">## [21] "lh_parsorbitalis"            "lh_parstriangularis"        </span></span>
<span><span class="co">## [23] "lh_pericalcarine"            "lh_postcentral"             </span></span>
<span><span class="co">## [25] "lh_posteriorcingulate"       "lh_precentral"              </span></span>
<span><span class="co">## [27] "lh_precuneus"                "lh_rostralanteriorcingulate"</span></span>
<span><span class="co">## [29] "lh_rostralmiddlefrontal"     "lh_superiorfrontal"         </span></span>
<span><span class="co">## [31] "lh_superiorparietal"         "lh_superiortemporal"        </span></span>
<span><span class="co">## [33] "lh_supramarginal"            "lh_temporalpole"            </span></span>
<span><span class="co">## [35] "lh_transversetemporal"       "rh_bankssts"                </span></span>
<span><span class="co">## [37] "rh_caudalanteriorcingulate"  "rh_caudalmiddlefrontal"     </span></span>
<span><span class="co">## [39] "rh_corpuscallosum"           "rh_cuneus"                  </span></span>
<span><span class="co">## [41] "rh_entorhinal"               "rh_frontalpole"             </span></span>
<span><span class="co">## [43] "rh_fusiform"                 "rh_inferiorparietal"        </span></span>
<span><span class="co">## [45] "rh_inferiortemporal"         "rh_insula"                  </span></span>
<span><span class="co">## [47] "rh_isthmuscingulate"         "rh_lateraloccipital"        </span></span>
<span><span class="co">## [49] "rh_lateralorbitofrontal"     "rh_lingual"                 </span></span>
<span><span class="co">## [51] "rh_medialorbitofrontal"      "rh_middletemporal"          </span></span>
<span><span class="co">## [53] "rh_paracentral"              "rh_parahippocampal"         </span></span>
<span><span class="co">## [55] "rh_parsopercularis"          "rh_parsorbitalis"           </span></span>
<span><span class="co">## [57] "rh_parstriangularis"         "rh_pericalcarine"           </span></span>
<span><span class="co">## [59] "rh_postcentral"              "rh_posteriorcingulate"      </span></span>
<span><span class="co">## [61] "rh_precentral"               "rh_precuneus"               </span></span>
<span><span class="co">## [63] "rh_rostralanteriorcingulate" "rh_rostralmiddlefrontal"    </span></span>
<span><span class="co">## [65] "rh_superiorfrontal"          "rh_superiorparietal"        </span></span>
<span><span class="co">## [67] "rh_superiortemporal"         "rh_supramarginal"           </span></span>
<span><span class="co">## [69] "rh_temporalpole"             "rh_transversetemporal"</span></span></code></pre>
<p>Names must match exactly, including case and spacing.</p>
</div>
<div class="section level2">
<h2 id="a-minimal-example">A minimal example<a class="anchor" aria-label="anchor" href="#a-minimal-example"></a>
</h2>
<p>Three regions, three p-values:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">some_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"superior temporal"</span>, <span class="st">"precentral"</span>, <span class="st">"lateral orbitofrontal"</span><span class="op">)</span>,</span>
<span>  p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.03</span>, <span class="fl">.6</span>, <span class="fl">.05</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">some_data</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">##   region                    p</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> superior temporal      0.03</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> precentral             0.6 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> lateral orbitofrontal  0.05</span></span></code></pre>
<p>Pass the data to <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> and map <code>fill</code> to
your variable:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">some_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span>atlas <span class="op">=</span> <span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Merging atlas and data by <span style="color: #00BB00;">region</span>.</span></span></code></pre>
<div class="figure">
<img src="external-data_files/figure-html/fig-minimal-plot-1.png" class="r-plt" alt="Brain plot with three regions coloured by p-value." width="576"><p class="caption">
Brain plot with three regions coloured by p-value.
</p>
</div>
<p>Regions not in your data appear as <code>NA</code> (grey by default).
Regions in your data that don’t match the atlas are silently dropped, so
watch your spelling.</p>
</div>
<div class="section level2">
<h2 id="constraining-matches-with-extra-columns">Constraining matches with extra columns<a class="anchor" aria-label="anchor" href="#constraining-matches-with-extra-columns"></a>
</h2>
<p>If your data is hemisphere-specific, add a <code>hemi</code> column.
The join will use both <code>region</code> and <code>hemi</code>, so
values only land on the correct side:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">some_data</span><span class="op">$</span><span class="va">hemi</span> <span class="op">&lt;-</span> <span class="st">"left"</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">some_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span>atlas <span class="op">=</span> <span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Merging atlas and data by <span style="color: #00BB00;">region</span> and <span style="color: #00BB00;">hemi</span>.</span></span></code></pre>
<div class="figure">
<img src="external-data_files/figure-html/fig-hemi-constraint-1.png" class="r-plt" alt="Brain plot restricted to the left hemisphere using a hemi column." width="576"><p class="caption">
Brain plot restricted to the left hemisphere using a hemi column.
</p>
</div>
<p>The same works for any atlas column – adding <code>view</code>, for
instance, would restrict matches to specific views.</p>
</div>
<div class="section level2">
<h2 id="faceting-across-groups">Faceting across groups<a class="anchor" aria-label="anchor" href="#faceting-across-groups"></a>
</h2>
<p>If your data has a grouping variable, <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap()</a></code> and
<code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid()</a></code> work as you’d expect.
<code><a href="../reference/ggbrain.html">geom_brain()</a></code> detects the faceting variables and replicates
the full atlas in each panel:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">some_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"transverse temporal"</span>,</span>
<span>      <span class="st">"insula"</span>,</span>
<span>      <span class="st">"precentral"</span>,</span>
<span>      <span class="st">"superior parietal"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fl">2</span></span>
<span>  <span class="op">)</span>,</span>
<span>  p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.5</span>, <span class="fl">.001</span><span class="op">)</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Young"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Old"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">some_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span>atlas <span class="op">=</span> <span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"white"</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">group</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span></span>
<span>    colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"royalblue"</span>, <span class="st">"firebrick"</span>, <span class="st">"goldenrod"</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"grey"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Merging atlas and data by <span style="color: #00BB00;">region</span>.</span></span></code></pre>
<div class="figure">
<img src="external-data_files/figure-html/fig-facet-groups-1.png" class="r-plt" alt="Brain plots faceted by age group with a custom colour gradient." width="576"><p class="caption">
Brain plots faceted by age group with a custom colour gradient.
</p>
</div>
<p>No need to call <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code> first – the geom handles
atlas replication automatically. (Explicit <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code> still
works for backward compatibility.)</p>
</div>
<div class="section level2">
<h2 id="the-pre-merged-workflow">The pre-merged workflow<a class="anchor" aria-label="anchor" href="#the-pre-merged-workflow"></a>
</h2>
<p>For full control over faceting or when you need to combine brain data
with other sf layers, convert the atlas to a data frame and join
manually:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">atlas_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">atlas_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "label"    "view"     "hemi"     "region"   "lobe"     "geometry" "atlas"   </span></span>
<span><span class="co">## [8] "type"     "colour"</span></span></code></pre>
<p>Then use a standard join and <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf()</a></code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">some_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"superior temporal"</span>, <span class="st">"precentral"</span>, <span class="st">"lateral orbitofrontal"</span><span class="op">)</span>,</span>
<span>  p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.03</span>, <span class="fl">.6</span>, <span class="fl">.05</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">atlas_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">some_data</span>, by <span class="op">=</span> <span class="st">"region"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">p</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">hemi</span> <span class="op">~</span> <span class="va">view</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="external-data_files/figure-html/fig-pre-merged-1.png" class="r-plt" alt="Brain plot using a manual left_join and geom_sf for full control." width="576"><p class="caption">
Brain plot using a manual left_join and geom_sf for full control.
</p>
</div>
<p>See <code><a href="../articles/geom-sf.html">vignette("geom-sf")</a></code> for more on this approach.</p>
</div>
<div class="section level2">
<h2 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h2>
<p><strong>Regions don’t show up.</strong> Check spelling and case.
<code>ggseg.formats::atlas_regions(dk())</code> gives you the exact
strings the atlas expects.</p>
<p><strong>Data lands on both hemispheres.</strong> Add a
<code>hemi</code> column with <code>"left"</code> or
<code>"right"</code> to constrain the match.</p>
<p><strong>Extra facet panels appear.</strong> This is handled
automatically by <code><a href="../reference/ggbrain.html">geom_brain()</a></code>. If you’re using the
<code><a href="../reference/brain_join.html">brain_join()</a></code> + <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf()</a></code> workflow directly,
<code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code> your data by the faceting variable before
joining.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="ggsegverse-footer py-3">
  <div class="container d-flex justify-content-between align-items-center flex-wrap">
    <div class="d-flex align-items-center">
      <a href="https://ggseg.github.io" class="external-link me-3">
        <img src="ggsegverse-logo.png" alt="ggsegverse" height="40"></a>
      <span class="text-muted">
        Part of the <a href="https://ggseg.github.io" class="external-link"><strong>ggsegverse</strong></a>
        — Gross Geometry Brain Segmentation Universe
      </span>
    </div>
    <div class="text-muted">
      Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>

    </div>
  </div>
</div>

    </footer>
</div>



  <script>
  document.addEventListener("DOMContentLoaded", function() {
    var brand = document.querySelector(".navbar-brand");
    if (!brand) return;
    var root = brand.getAttribute("href").replace("index.html", "");
    document.querySelectorAll(
      '#ggsegverse-logo, .ggsegverse-footer img[alt="ggsegverse"]'
    ).forEach(function(img) { img.src = root + "ggsegverse-logo.png"; });
  });
</script>
</body>
</html>
