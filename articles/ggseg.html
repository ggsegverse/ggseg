<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting started with ggseg • ggseg</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Inter-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with ggseg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://ggseg.github.io" class="external-link">
  <img src="ggsegverse-logo.png" id="ggsegverse-logo" alt="ggsegverse"></a>

    <a class="navbar-brand me-2" href="../index.html">ggseg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/ggseg.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="../articles/ggseg.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/external-data.html">External Data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced Usage</h6></li>
    <li><a class="dropdown-item" href="../articles/positioning-views.html">Positioning Views</a></li>
    <li><a class="dropdown-item" href="../articles/geom-sf.html">Using geom_sf</a></li>
    <li><a class="dropdown-item" href="../articles/freesurfer-files.html">FreeSurfer Files</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ggsegverse/ggseg" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Getting started with ggseg</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ggsegverse/ggseg/blob/main/vignettes/ggseg.Rmd" class="external-link"><code>vignettes/ggseg.Rmd</code></a></small>
      <div class="d-none name"><code>ggseg.Rmd</code></div>
    </div>

    
    
<p>If you work with neuroimaging data, you’ve probably spent time
wrestling region-level results into brain plots. ggseg handles that
plumbing for you. It stores brain atlas geometries as simple features
and plots them as ggplot2 layers, so you get brain figures with the same
code you’d use for any other ggplot.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggsegverse.github.io/ggseg/">ggseg</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="whats-in-a-brain-atlas">What’s in a brain atlas<a class="anchor" aria-label="anchor" href="#whats-in-a-brain-atlas"></a>
</h2>
<p>A <code>brain_atlas</code> object bundles four things: a name, a type
(cortical, subcortical, or tract), region geometry stored as simple
features, and an optional colour palette.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dk</span></span>
<span><span class="co">#&gt; function () </span></span>
<span><span class="co">#&gt; .dk_atlas</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x563c4988d4e0&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: namespace:ggseg.formats&gt;</span></span></code></pre></div>
<p>The <code>dk</code> atlas (Desikan-Killiany) ships with the package.
Call <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> for a quick look:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggseg_files/figure-html/fig-dk-plot-1.png" class="r-plt" alt="Quick overview of the Desikan-Killiany cortical atlas." width="576"><p class="caption">
Quick overview of the Desikan-Killiany cortical atlas.
</p>
</div>
<p>Two helpers pull out the names you’ll need for matching data:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggseg.formats</span><span class="fu">::</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/atlas_regions.html">atlas_regions</a></span><span class="op">(</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "banks of superior temporal sulcus" "caudal anterior cingulate"        </span></span>
<span><span class="co">#&gt;  [3] "caudal middle frontal"             "corpus callosum"                  </span></span>
<span><span class="co">#&gt;  [5] "cuneus"                            "entorhinal"                       </span></span>
<span><span class="co">#&gt;  [7] "frontal pole"                      "fusiform"                         </span></span>
<span><span class="co">#&gt;  [9] "inferior parietal"                 "inferior temporal"                </span></span>
<span><span class="co">#&gt; [11] "insula"                            "isthmus cingulate"                </span></span>
<span><span class="co">#&gt; [13] "lateral occipital"                 "lateral orbitofrontal"            </span></span>
<span><span class="co">#&gt; [15] "lingual"                           "medial orbitofrontal"             </span></span>
<span><span class="co">#&gt; [17] "middle temporal"                   "paracentral"                      </span></span>
<span><span class="co">#&gt; [19] "parahippocampal"                   "pars opercularis"                 </span></span>
<span><span class="co">#&gt; [21] "pars orbitalis"                    "pars triangularis"                </span></span>
<span><span class="co">#&gt; [23] "pericalcarine"                     "postcentral"                      </span></span>
<span><span class="co">#&gt; [25] "posterior cingulate"               "precentral"                       </span></span>
<span><span class="co">#&gt; [27] "precuneus"                         "rostral anterior cingulate"       </span></span>
<span><span class="co">#&gt; [29] "rostral middle frontal"            "superior frontal"                 </span></span>
<span><span class="co">#&gt; [31] "superior parietal"                 "superior temporal"                </span></span>
<span><span class="co">#&gt; [33] "supramarginal"                     "temporal pole"                    </span></span>
<span><span class="co">#&gt; [35] "transverse temporal"</span></span>
<span><span class="fu">ggseg.formats</span><span class="fu">::</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/atlas_labels.html">atlas_labels</a></span><span class="op">(</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "lh_bankssts"                 "lh_caudalanteriorcingulate" </span></span>
<span><span class="co">#&gt;  [3] "lh_caudalmiddlefrontal"      "lh_corpuscallosum"          </span></span>
<span><span class="co">#&gt;  [5] "lh_cuneus"                   "lh_entorhinal"              </span></span>
<span><span class="co">#&gt;  [7] "lh_frontalpole"              "lh_fusiform"                </span></span>
<span><span class="co">#&gt;  [9] "lh_inferiorparietal"         "lh_inferiortemporal"        </span></span>
<span><span class="co">#&gt; [11] "lh_insula"                   "lh_isthmuscingulate"        </span></span>
<span><span class="co">#&gt; [13] "lh_lateraloccipital"         "lh_lateralorbitofrontal"    </span></span>
<span><span class="co">#&gt; [15] "lh_lingual"                  "lh_medialorbitofrontal"     </span></span>
<span><span class="co">#&gt; [17] "lh_middletemporal"           "lh_paracentral"             </span></span>
<span><span class="co">#&gt; [19] "lh_parahippocampal"          "lh_parsopercularis"         </span></span>
<span><span class="co">#&gt; [21] "lh_parsorbitalis"            "lh_parstriangularis"        </span></span>
<span><span class="co">#&gt; [23] "lh_pericalcarine"            "lh_postcentral"             </span></span>
<span><span class="co">#&gt; [25] "lh_posteriorcingulate"       "lh_precentral"              </span></span>
<span><span class="co">#&gt; [27] "lh_precuneus"                "lh_rostralanteriorcingulate"</span></span>
<span><span class="co">#&gt; [29] "lh_rostralmiddlefrontal"     "lh_superiorfrontal"         </span></span>
<span><span class="co">#&gt; [31] "lh_superiorparietal"         "lh_superiortemporal"        </span></span>
<span><span class="co">#&gt; [33] "lh_supramarginal"            "lh_temporalpole"            </span></span>
<span><span class="co">#&gt; [35] "lh_transversetemporal"       "rh_bankssts"                </span></span>
<span><span class="co">#&gt; [37] "rh_caudalanteriorcingulate"  "rh_caudalmiddlefrontal"     </span></span>
<span><span class="co">#&gt; [39] "rh_corpuscallosum"           "rh_cuneus"                  </span></span>
<span><span class="co">#&gt; [41] "rh_entorhinal"               "rh_frontalpole"             </span></span>
<span><span class="co">#&gt; [43] "rh_fusiform"                 "rh_inferiorparietal"        </span></span>
<span><span class="co">#&gt; [45] "rh_inferiortemporal"         "rh_insula"                  </span></span>
<span><span class="co">#&gt; [47] "rh_isthmuscingulate"         "rh_lateraloccipital"        </span></span>
<span><span class="co">#&gt; [49] "rh_lateralorbitofrontal"     "rh_lingual"                 </span></span>
<span><span class="co">#&gt; [51] "rh_medialorbitofrontal"      "rh_middletemporal"          </span></span>
<span><span class="co">#&gt; [53] "rh_paracentral"              "rh_parahippocampal"         </span></span>
<span><span class="co">#&gt; [55] "rh_parsopercularis"          "rh_parsorbitalis"           </span></span>
<span><span class="co">#&gt; [57] "rh_parstriangularis"         "rh_pericalcarine"           </span></span>
<span><span class="co">#&gt; [59] "rh_postcentral"              "rh_posteriorcingulate"      </span></span>
<span><span class="co">#&gt; [61] "rh_precentral"               "rh_precuneus"               </span></span>
<span><span class="co">#&gt; [63] "rh_rostralanteriorcingulate" "rh_rostralmiddlefrontal"    </span></span>
<span><span class="co">#&gt; [65] "rh_superiorfrontal"          "rh_superiorparietal"        </span></span>
<span><span class="co">#&gt; [67] "rh_superiortemporal"         "rh_supramarginal"           </span></span>
<span><span class="co">#&gt; [69] "rh_temporalpole"             "rh_transversetemporal"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="your-first-brain-plot">Your first brain plot<a class="anchor" aria-label="anchor" href="#your-first-brain-plot"></a>
</h2>
<p><code><a href="../reference/ggbrain.html">geom_brain()</a></code> works like any ggplot2 geom. Pass it an
atlas and it draws the regions:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span>atlas <span class="op">=</span> <span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggseg_files/figure-html/fig-basic-brain-1.png" class="r-plt" alt="Default brain plot using geom_brain() with the dk atlas." width="576"><p class="caption">
Default brain plot using geom_brain() with the dk atlas.
</p>
</div>
</div>
<div class="section level2">
<h2 id="arranging-views">Arranging views<a class="anchor" aria-label="anchor" href="#arranging-views"></a>
</h2>
<p>Brain atlases have multiple views (lateral, medial) and hemispheres.
<code><a href="../reference/position_brain.html">position_brain()</a></code> controls how they’re laid out, using
formula syntax borrowed from <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span>atlas <span class="op">=</span> <span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span>, position <span class="op">=</span> <span class="fu"><a href="../reference/position_brain.html">position_brain</a></span><span class="op">(</span><span class="va">hemi</span> <span class="op">~</span> <span class="va">view</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggseg_files/figure-html/fig-position-formula-1.png" class="r-plt" alt="Brain views arranged using formula syntax in position_brain()." width="576"><p class="caption">
Brain views arranged using formula syntax in position_brain().
</p>
</div>
<p>Or reorder views with a character vector:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    atlas <span class="op">=</span> <span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="../reference/position_brain.html">position_brain</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"right lateral"</span>, <span class="st">"right medial"</span>,</span>
<span>      <span class="st">"left lateral"</span>, <span class="st">"left medial"</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggseg_files/figure-html/fig-position-character-1.png" class="r-plt" alt="Brain views arranged using a character vector to specify order." width="576"><p class="caption">
Brain views arranged using a character vector to specify order.
</p>
</div>
<p>See <code><a href="../articles/positioning-views.html">vignette("positioning-views")</a></code> for the full set of
layout options, including grid layouts for subcortical and tract
atlases.</p>
</div>
<div class="section level2">
<h2 id="showing-only-certain-hemispheres-or-views">Showing only certain hemispheres or views<a class="anchor" aria-label="anchor" href="#showing-only-certain-hemispheres-or-views"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span>atlas <span class="op">=</span> <span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span>, view <span class="op">=</span> <span class="st">"lateral"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggseg_files/figure-html/fig-filter-lateral-1.png" class="r-plt" alt="Brain plot showing only lateral views." width="576"><p class="caption">
Brain plot showing only lateral views.
</p>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span>atlas <span class="op">=</span> <span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span>, hemi <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ggseg_files/figure-html/fig-filter-left-1.png" class="r-plt" alt="Brain plot showing only the left hemisphere." width="576"><p class="caption">
Brain plot showing only the left hemisphere.
</p>
</div>
<p>For subcortical atlases, views are slice identifiers. Check what’s
available with <code><a href="https://ggsegverse.github.io/ggseg.formats/reference/atlas_views.html">ggseg.formats::atlas_views()</a></code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggseg.formats</span><span class="fu">::</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/atlas_views.html">atlas_views</a></span><span class="op">(</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/aseg.html">aseg</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "axial_3"   "axial_4"   "axial_5"   "axial_6"   "coronal_1" "coronal_2"</span></span>
<span><span class="co">#&gt; [7] "sagittal"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plotting-your-own-data">Plotting your own data<a class="anchor" aria-label="anchor" href="#plotting-your-own-data"></a>
</h2>
<p>Create a data frame with at least one column that matches the atlas
(typically <code>region</code> or <code>label</code>).
<code><a href="../reference/ggbrain.html">geom_brain()</a></code> joins your data to the atlas
automatically:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="va">some_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"transverse temporal"</span>, <span class="st">"insula"</span>, <span class="st">"precentral"</span>, <span class="st">"superior parietal"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.5</span>, <span class="fl">.001</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">some_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    atlas <span class="op">=</span> <span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="../reference/position_brain.html">position_brain</a></span><span class="op">(</span><span class="va">hemi</span> <span class="op">~</span> <span class="va">view</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"cividis"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Merging atlas and data by <span style="color: #00BB00;">region</span>.</span></span></code></pre></div>
<div class="figure">
<img src="ggseg_files/figure-html/fig-external-data-1.png" class="r-plt" alt="Brain plot coloured by external p-values using a viridis scale." width="576"><p class="caption">
Brain plot coloured by external p-values using a viridis scale.
</p>
</div>
<p>See <code><a href="../articles/external-data.html">vignette("external-data")</a></code> for more on data
preparation and matching.</p>
</div>
<div class="section level2">
<h2 id="faceting">Faceting<a class="anchor" aria-label="anchor" href="#faceting"></a>
</h2>
<p>ggplot2 faceting works as you’d expect. <code><a href="../reference/ggbrain.html">geom_brain()</a></code>
detects faceting variables and replicates the full atlas in each
panel:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">some_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"transverse temporal"</span>, <span class="st">"insula"</span>, <span class="st">"precentral"</span>, <span class="st">"superior parietal"</span></span>
<span>  <span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.5</span>, <span class="fl">.001</span><span class="op">)</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">some_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span></span>
<span>    atlas <span class="op">=</span> <span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="../reference/position_brain.html">position_brain</a></span><span class="op">(</span><span class="va">hemi</span> <span class="op">~</span> <span class="va">view</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="co">#&gt; Merging atlas and data by <span style="color: #00BB00;">region</span>.</span></span></code></pre></div>
<div class="figure">
<img src="ggseg_files/figure-html/fig-faceting-1.png" class="r-plt" alt="Brain plots faceted by group, each panel showing the full atlas." width="576"><p class="caption">
Brain plots faceted by group, each panel showing the full atlas.
</p>
</div>
<p>No <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code> needed – the geom handles it.</p>
</div>
<div class="section level2">
<h2 id="highlighting-specific-regions">Highlighting specific regions<a class="anchor" aria-label="anchor" href="#highlighting-specific-regions"></a>
</h2>
<p>To colour a few regions with their atlas colours, use two columns:
one for the join (<code>region</code>) and one for the fill
aesthetic:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  region <span class="op">=</span> <span class="fu">ggseg.formats</span><span class="fu">::</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/atlas_regions.html">atlas_regions</a></span><span class="op">(</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  reg_col <span class="op">=</span> <span class="fu">ggseg.formats</span><span class="fu">::</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/atlas_regions.html">atlas_regions</a></span><span class="op">(</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span>atlas <span class="op">=</span> <span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">reg_col</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/scale_brain_manual.html">scale_fill_brain_manual</a></span><span class="op">(</span><span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">palette</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">region</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; Merging atlas and data by <span style="color: #00BB00;">region</span>.</span></span></code></pre></div>
<div class="figure">
<img src="ggseg_files/figure-html/fig-highlighting-1.png" class="r-plt" alt="Highlighting selected regions using the atlas colour palette." width="576"><p class="caption">
Highlighting selected regions using the atlas colour palette.
</p>
</div>
</div>
<div class="section level2">
<h2 id="scales-and-themes">Scales and themes<a class="anchor" aria-label="anchor" href="#scales-and-themes"></a>
</h2>
<p>Atlas colour palettes are applied automatically by
<code><a href="../reference/ggbrain.html">geom_brain()</a></code>. For custom palettes, use
<code><a href="../reference/scale_brain_manual.html">scale_fill_brain_manual()</a></code>.</p>
<p>Built-in themes strip axes and grids for cleaner figures:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span>atlas <span class="op">=</span> <span class="fu"><a href="https://ggsegverse.github.io/ggseg.formats/reference/dk.html">dk</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_brain.html">theme_brain</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="finding-more-atlases">Finding more atlases<a class="anchor" aria-label="anchor" href="#finding-more-atlases"></a>
</h2>
<p>ggseg ships with <code>dk</code> (cortical), <code>aseg</code>
(subcortical), and <code>tracula</code> (white matter tracts). Many more
are available through the <a href="https://ggsegverse.r-universe.dev" class="external-link">ggsegverse r-universe</a>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggsegYeo2011"</span>, repos <span class="op">=</span> <span class="st">"https://ggsegverse.r-universe.dev"</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="ggsegverse-footer py-3">
  <div class="container d-flex justify-content-between align-items-center flex-wrap">
    <div class="d-flex align-items-center">
      <a href="https://ggseg.github.io" class="external-link me-3">
        <img src="ggsegverse-logo.png" alt="ggsegverse" height="40"></a>
      <span class="text-muted">
        Part of the <a href="https://ggseg.github.io" class="external-link"><strong>ggsegverse</strong></a>
        — Gross Geometry Brain Segmentation Universe
      </span>
    </div>
    <div class="text-muted">
      Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>

    </div>
  </div>
</div>

    </footer>
</div>



  <script>
  document.addEventListener("DOMContentLoaded", function() {
    var brand = document.querySelector(".navbar-brand");
    if (!brand) return;
    var root = brand.getAttribute("href").replace("index.html", "");
    document.querySelectorAll(
      '#ggsegverse-logo, .ggsegverse-footer img[alt="ggsegverse"]'
    ).forEach(function(img) { img.src = root + "ggsegverse-logo.png"; });
  });
</script>
</body>
</html>
